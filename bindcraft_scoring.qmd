---
title: "BindCraft : analysing a full design run"
format:
  html:
    license: CC BY
    embed-resources: true
---

We've run 400 BindCraft trajectories for PDL1 using `nf-binder-design` -the results are in `/scratch2/pd27/shared/examples/nfbd/pdl1-bindcraft` - this reflects a more realistic number of trajectories for a 'production run'.

::: {.callout-caution}

### Challenge - viewing the BindCraft results

View the table `final_design_stats.csv` - how many accepted designs do we have ? What is the acceptance rate ?

What do the designs with almost the same name, but different `_mpnn{n}` suffixes have in common ?

View a the the PDB files in `Accepted/`. Examine the target-binder interface of some designs with high and low ipTM scores.

:::

BindCraft outputs many scores, but for ranking designs we'd typically focus on:

- `Average_i_pTM` - the average ipTM across each Alphafold2 model for this complex

> Note that since fairly stringent filters have already been applied, _any_ of the Accepted designs is considered to have a good chance of binding.

Here are all the scores you'll find in the `final_design_stats.csv` file.
The 1_, 2_, 3_, etc scores are for each different Alphafold2 model:

```
Rank,Design,Protocol,Length,Seed,Helicity,Target_Hotspot,Sequence,InterfaceResidues,

MPNN_score,MPNN_seq_recovery,

Average_pLDDT,			1_pLDDT,2_pLDDT,3_pLDDT,4_pLDDT,5_pLDDT,
Average_pTM,			1_pTM,2_pTM,3_pTM,4_pTM,5_pTM,
Average_i_pTM,			1_i_pTM,2_i_pTM,3_i_pTM,4_i_pTM,5_i_pTM,
Average_pAE,			1_pAE,2_pAE,3_pAE,4_pAE,5_pAE,
Average_i_pAE,			1_i_pAE,2_i_pAE,3_i_pAE,4_i_pAE,5_i_pAE,
Average_i_pLDDT,		1_i_pLDDT,2_i_pLDDT,3_i_pLDDT,4_i_pLDDT,5_i_pLDDT,
Average_ss_pLDDT,		1_ss_pLDDT,2_ss_pLDDT,3_ss_pLDDT,4_ss_pLDDT,5_ss_pLDDT,

Average_Unrelaxed_Clashes,	1_Unrelaxed_Clashes,2_Unrelaxed_Clashes,3_Unrelaxed_Clashes,4_Unrelaxed_Clashes,5_Unrelaxed_Clashes,
Average_Relaxed_Clashes,	1_Relaxed_Clashes,2_Relaxed_Clashes,3_Relaxed_Clashes,4_Relaxed_Clashes,5_Relaxed_Clashes,
Average_Binder_Energy_Score,	1_Binder_Energy_Score,2_Binder_Energy_Score,3_Binder_Energy_Score,4_Binder_Energy_Score,5_Binder_Energy_Score,
Average_Surface_Hydrophobicity,	1_Surface_Hydrophobicity,2_Surface_Hydrophobicity,3_Surface_Hydrophobicity,4_Surface_Hydrophobicity,5_Surface_Hydrophobicity,
Average_ShapeComplementarity,	1_ShapeComplementarity,2_ShapeComplementarity,3_ShapeComplementarity,4_ShapeComplementarity,5_ShapeComplementarity,
Average_PackStat,		1_PackStat,2_PackStat,3_PackStat,4_PackStat,5_PackStat,
Average_dG,			1_dG,2_dG,3_dG,4_dG,5_dG,
Average_dSASA,			1_dSASA,2_dSASA,3_dSASA,4_dSASA,5_dSASA,
Average_dG/dSASA,		1_dG/dSASA,2_dG/dSASA,3_dG/dSASA,4_dG/dSASA,5_dG/dSASA,
Average_Interface_SASA_%,	1_Interface_SASA_%,2_Interface_SASA_%,3_Interface_SASA_%,4_Interface_SASA_%,5_Interface_SASA_%,
Average_Interface_Hydrophobicity,	1_Interface_Hydrophobicity,2_Interface_Hydrophobicity,3_Interface_Hydrophobicity,4_Interface_Hydrophobicity,5_Interface_Hydrophobicity,
Average_n_InterfaceResidues,	1_n_InterfaceResidues,2_n_InterfaceResidues,3_n_InterfaceResidues,4_n_InterfaceResidues,5_n_InterfaceResidues,
Average_n_InterfaceHbonds,	1_n_InterfaceHbonds,2_n_InterfaceHbonds,3_n_InterfaceHbonds,4_n_InterfaceHbonds,5_n_InterfaceHbonds,
Average_InterfaceHbondsPercentage,	1_InterfaceHbondsPercentage,2_InterfaceHbondsPercentage,3_InterfaceHbondsPercentage,4_InterfaceHbondsPercentage,5_InterfaceHbondsPercentage,
Average_n_InterfaceUnsatHbonds,	1_n_InterfaceUnsatHbonds,2_n_InterfaceUnsatHbonds,3_n_InterfaceUnsatHbonds,4_n_InterfaceUnsatHbonds,5_n_InterfaceUnsatHbonds,
Average_InterfaceUnsatHbondsPercentage,	1_InterfaceUnsatHbondsPercentage,2_InterfaceUnsatHbondsPercentage,3_InterfaceUnsatHbondsPercentage,4_InterfaceUnsatHbondsPercentage,5_InterfaceUnsatHbondsPercentage,

Average_Interface_Helix%,		1_Interface_Helix%,2_Interface_Helix%,3_Interface_Helix%,4_Interface_Helix%,5_Interface_Helix%,
Average_Interface_BetaSheet%,		1_Interface_BetaSheet%,2_Interface_BetaSheet%,3_Interface_BetaSheet%,4_Interface_BetaSheet%,5_Interface_BetaSheet%,
Average_Interface_Loop%,		1_Interface_Loop%,2_Interface_Loop%,3_Interface_Loop%,4_Interface_Loop%,5_Interface_Loop%,
Average_Binder_Helix%,			1_Binder_Helix%,2_Binder_Helix%,3_Binder_Helix%,4_Binder_Helix%,5_Binder_Helix%,
Average_Binder_BetaSheet%,		1_Binder_BetaSheet%,2_Binder_BetaSheet%,3_Binder_BetaSheet%,4_Binder_BetaSheet%,5_Binder_BetaSheet%,
Average_Binder_Loop%,			1_Binder_Loop%,2_Binder_Loop%,3_Binder_Loop%,4_Binder_Loop%,5_Binder_Loop%,

Average_InterfaceAAs,		1_InterfaceAAs,2_InterfaceAAs,3_InterfaceAAs,4_InterfaceAAs,5_InterfaceAAs,

Average_Hotspot_RMSD,		1_Hotspot_RMSD,2_Hotspot_RMSD,3_Hotspot_RMSD,4_Hotspot_RMSD,5_Hotspot_RMSD,
Average_Target_RMSD,		1_Target_RMSD,2_Target_RMSD,3_Target_RMSD,4_Target_RMSD,5_Target_RMSD,
Average_Binder_pLDDT,		1_Binder_pLDDT,2_Binder_pLDDT,3_Binder_pLDDT,4_Binder_pLDDT,5_Binder_pLDDT,
Average_Binder_pTM,		1_Binder_pTM,2_Binder_pTM,3_Binder_pTM,4_Binder_pTM,5_Binder_pTM,
Average_Binder_pAE,		1_Binder_pAE,2_Binder_pAE,3_Binder_pAE,4_Binder_pAE,5_Binder_pAE,
Average_Binder_RMSD,		1_Binder_RMSD,2_Binder_RMSD,3_Binder_RMSD,4_Binder_RMSD,5_Binder_RMSD,

DesignTime,Notes,TargetSettings,Filters,AdvancedSettings
```

#### Default filters

Designs that satisfy these critera are kept as 'Accepted':

- **AlphaFold2 Metrics**
    - `Average_pLDDT` > 0.8
    - `Average_pTM` > 0.55
    - `Average_i_pTM` > 0.5
    - `Average_i_pAE` < 0.35

- **Rosetta Metrics**
    - `Average_Binder_Energy_Score` < 0
    - `Average_Surface_Hydrophobicity` < 0.35
    - `Average_ShapeComplementarity` > 0.6
    - `Average_dG` < 0
    - `Average_dSASA` > 1
    - `Average_n_InterfaceResidues` > 7
    - `Average_n_InterfaceHbonds` > 3
    - `Average_n_InterfaceUnsatHbonds` < 4
    - `Average_InterfaceAAs: K` < 3
    - `Average_InterfaceAAs: M` < 3

- **Structural Metrics**
    - `Average_Binder_Loop%` < 90
    - `Average_Hotspot_RMSD` < 6
    - `Average_Binder_pLDDT` > 0.8
    - `Average_Binder_RMSD` < 3.5


# Optimizing BindCraft settings

It can take 'many shots' _in silico_ to get a 'one shot' binder in the wet lab.

Here's a figure from the BindCraft paper that gives some insight:

![Supplementary Fig. 1 from Pacesa et al, _Nature_, 2025 (https://doi.org/10.1038/s41586-025-09429-6) - shows the number of trajectories, number passing initially AF2](assets/images/bindcraft_success_rates.png)'

Each target required different numbers of trajectories, with a wide range in _in silico_ acceptance rates, to achieve the suggested "100 accepted designs to select 20 for assay" benchmark. **Part f** shows the impact of binder length range alone on _in silico_ success rates. 

What we **don't** see here is the trajactories run testing alternative target structures, trimmings and hotspot combinations - expect to run many more trajectories than you'll ultimately require for your final 'production' run.

The two key parameters you should adjust to get more 'accepted' designs are:

  - the target structure (different models, different trimmings)
  - the hotspots

Modifying the default filters or advanced settings should typically be approached with extreme caution - not all 'advanced' settings have been systematically tested and may reduce the success rates reported in the BindCraft paper. _Caveat emptor_